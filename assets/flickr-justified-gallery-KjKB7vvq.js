/*!
 * Flickr's Justified Gallery [fjGallery] v2.2.0 (https://flickr-justified-gallery.nkdev.info)
 * Copyright 2024 nK <https://nkdev.info>
 * Licensed under MIT (https://github.com/nk-o/flickr-justified-gallery/blob/master/LICENSE)
 */function P(t,e,i){var n=i||{},o=n.noTrailing,s=o===void 0?!1:o,a=n.noLeading,r=a===void 0?!1:a,h=n.debounceMode,l=h===void 0?void 0:h,c,d=!1,x=0;function v(){c&&clearTimeout(c)}function O(w){var R=w||{},f=R.upcomingOnly,H=f===void 0?!1:f;v(),d=!H}function I(){for(var w=arguments.length,R=new Array(w),f=0;f<w;f++)R[f]=arguments[f];var H=this,L=Date.now()-x;if(d)return;function m(){x=Date.now(),e.apply(H,R)}function S(){c=void 0}!r&&l&&!c&&m(),v(),l===void 0&&L>t?r?(x=Date.now(),s||(c=setTimeout(l?S:m,t))):m():s!==!0&&(c=setTimeout(l?S:m,l===void 0?t-L:t))}return I.cancel=O,I}function F(t,e,i){var n={},o=n.atBegin,s=o===void 0?!1:o;return P(t,e,{debounceMode:s!==!1})}var T=function(e){var i=[],n=null,o=function(){for(var a=arguments.length,r=new Array(a),h=0;h<a;h++)r[h]=arguments[h];i=r,!n&&(n=requestAnimationFrame(function(){n=null,e.apply(void 0,i)}))};return o.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},o};function N(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}const _=function(t){this.index=t.index,this.top=t.top,this.left=t.left,this.width=t.width,this.spacing=t.spacing,this.targetRowHeight=t.targetRowHeight,this.targetRowHeightTolerance=t.targetRowHeightTolerance,this.minAspectRatio=this.width/t.targetRowHeight*(1-t.targetRowHeightTolerance),this.maxAspectRatio=this.width/t.targetRowHeight*(1+t.targetRowHeightTolerance),this.edgeCaseMinRowHeight=t.edgeCaseMinRowHeight,this.edgeCaseMaxRowHeight=t.edgeCaseMaxRowHeight,this.widowLayoutStyle=t.widowLayoutStyle,this.isBreakoutRow=t.isBreakoutRow,this.items=[],this.height=0};_.prototype={addItem:function(t){const e=this.items.concat(t),i=this.width-(e.length-1)*this.spacing,n=e.reduce(function(h,l){return h+l.aspectRatio},0),o=i/this.targetRowHeight;let s,a,r;return this.isBreakoutRow&&this.items.length===0&&t.aspectRatio>=1?(this.items.push(t),this.completeLayout(i/t.aspectRatio,"justify"),!0):n<this.minAspectRatio?(this.items.push(Object.assign({},t)),!0):n>this.maxAspectRatio?this.items.length===0?(this.items.push(Object.assign({},t)),this.completeLayout(i/n,"justify"),!0):(s=this.width-(this.items.length-1)*this.spacing,a=this.items.reduce(function(h,l){return h+l.aspectRatio},0),r=s/this.targetRowHeight,Math.abs(n-o)>Math.abs(a-r)?(this.completeLayout(s/a,"justify"),!1):(this.items.push(Object.assign({},t)),this.completeLayout(i/n,"justify"),!0)):(this.items.push(Object.assign({},t)),this.completeLayout(i/n,"justify"),!0)},isLayoutComplete:function(){return this.height>0},completeLayout:function(t,e){let i=this.left;const n=this.width-(this.items.length-1)*this.spacing;let o,s,a,r,h,l;(typeof e>"u"||["justify","center","left"].indexOf(e)<0)&&(e="left"),s=Math.max(this.edgeCaseMinRowHeight,Math.min(t,this.edgeCaseMaxRowHeight)),t!==s?(this.height=s,o=n/s/(n/t)):(this.height=t,o=1),this.items.forEach(function(c){c.row=this.index,c.top=this.top,c.width=c.aspectRatio*this.height*o,c.height=this.height,c.left=i,i+=c.width+this.spacing},this),e==="justify"?(i-=this.spacing+this.left,a=(i-this.width)/this.items.length,r=this.items.map(function(c,d){return Math.round((d+1)*a)}),this.items.length===1?(h=this.items[0],h.width-=Math.round(a)):this.items.forEach(function(c,d){d>0?(c.left-=r[d-1],c.width-=r[d]-r[d-1]):c.width-=r[d]})):e==="center"&&(l=(this.width-i)/2,this.items.forEach(function(c){c.left+=l+this.spacing},this))},forceComplete:function(t,e){typeof e=="number"?this.completeLayout(e,this.widowLayoutStyle):this.completeLayout(this.targetRowHeight,this.widowLayoutStyle)},getItems:function(){return this.items}};/*!
 * Copyright 2019 SmugMug, Inc. | Copyright 2024 nK
 * Licensed under the terms of the MIT license. Please see LICENSE file in the project root for terms.
 * @license
 */function j(t,e){let i;return t.fullWidthBreakoutRowCadence!==!1&&(e._rows.length+1)%t.fullWidthBreakoutRowCadence===0&&(i=!0),new _({index:e._rows.length,top:e._containerHeight,left:t.containerPadding.left,width:t.containerWidth-t.containerPadding.left-t.containerPadding.right,spacing:t.boxSpacing.horizontal,targetRowHeight:t.targetRowHeight,targetRowHeightTolerance:t.targetRowHeightTolerance,edgeCaseMinRowHeight:t.edgeCaseMinRowHeight*t.targetRowHeight,edgeCaseMaxRowHeight:t.edgeCaseMaxRowHeight*t.targetRowHeight,isBreakoutRow:i,widowLayoutStyle:t.widowLayoutStyle})}function y(t,e,i){return e._rows.push(i),e._layoutItems=e._layoutItems.concat(i.getItems()),e._containerHeight+=i.height+t.boxSpacing.vertical,i.items}function A(t,e,i){let n=[],o,s,a;return t.forceAspectRatio&&i.forEach(function(r){r.forcedAspectRatio=!0,r.aspectRatio=t.forceAspectRatio}),i.some(function(r,h){if(isNaN(r.aspectRatio))throw new Error("Item "+h+" has an invalid aspect ratio");if(s||(s=j(t,e)),o=s.addItem(r),s.isLayoutComplete()){if(n=n.concat(y(t,e,s)),e._rows.length>=t.maxNumRows)return s=null,!0;if(s=j(t,e),!o&&(o=s.addItem(r),s.isLayoutComplete())){if(n=n.concat(y(t,e,s)),e._rows.length>=t.maxNumRows)return s=null,!0;s=j(t,e)}}}),s&&s.getItems().length&&t.showWidows&&(e._rows.length?(e._rows[e._rows.length-1].isBreakoutRow?a=e._rows[e._rows.length-1].targetRowHeight:a=e._rows[e._rows.length-1].height,s.forceComplete(!1,a)):s.forceComplete(!1),n=n.concat(y(t,e,s)),t._widowCount=s.getItems().length),e._containerHeight=e._containerHeight-t.boxSpacing.vertical,e._containerHeight=e._containerHeight+t.containerPadding.bottom,{containerHeight:e._containerHeight,widowCount:t._widowCount,boxes:e._layoutItems}}function W(t,e){let i={};const n={},o={containerWidth:1060,containerPadding:10,boxSpacing:10,targetRowHeight:320,targetRowHeightTolerance:.25,edgeCaseMinRowHeight:.5,edgeCaseMaxRowHeight:2.5,maxNumRows:Number.POSITIVE_INFINITY,forceAspectRatio:!1,showWidows:!0,fullWidthBreakoutRowCadence:!1,widowLayoutStyle:"left"},s={},a={};return e=e||{},i=Object.assign(o,e),s.top=isNaN(parseFloat(i.containerPadding.top))?i.containerPadding:i.containerPadding.top,s.right=isNaN(parseFloat(i.containerPadding.right))?i.containerPadding:i.containerPadding.right,s.bottom=isNaN(parseFloat(i.containerPadding.bottom))?i.containerPadding:i.containerPadding.bottom,s.left=isNaN(parseFloat(i.containerPadding.left))?i.containerPadding:i.containerPadding.left,a.horizontal=isNaN(parseFloat(i.boxSpacing.horizontal))?i.boxSpacing:i.boxSpacing.horizontal,a.vertical=isNaN(parseFloat(i.boxSpacing.vertical))?i.boxSpacing:i.boxSpacing.vertical,i.containerPadding=s,i.boxSpacing=a,n._layoutItems=[],n._awakeItems=[],n._inViewportItems=[],n._leadingOrphans=[],n._trailingOrphans=[],n._containerHeight=i.containerPadding.top,n._rows=[],n._orphans=[],i._widowCount=0,A(i,n,t.map(function(r){return r.width&&r.height?{aspectRatio:r.width/r.height}:{aspectRatio:r}}))}var C=W,z=N(C);function G(t){document.readyState==="complete"||document.readyState==="interactive"?t():document.addEventListener("DOMContentLoaded",t,{capture:!0,once:!0,passive:!0})}let u;typeof window<"u"?u=window:typeof global<"u"?u=global:typeof self<"u"?u=self:u={};var g=u;function B(t,e){let i,n=!1,o=!1;const s=()=>{if(n){e(n);return}t.naturalWidth&&(n={width:t.naturalWidth,height:t.naturalHeight},e(n),clearInterval(i),o&&c())},a=()=>{s()},r=()=>{s()},h=()=>{t.naturalWidth>0&&s()},l=()=>{o=!0,t.addEventListener("load",a),t.addEventListener("error",r)},c=()=>{o=!1,t.removeEventListener("load",a),t.removeEventListener("error",r)};h(),n||(l(),i=setInterval(h,100))}const b=[],p=T(()=>{b.forEach(t=>{t.resize()})});g.addEventListener("resize",p);g.addEventListener("orientationchange",p);g.addEventListener("load",p);G(()=>{p()});let E=0;class M{constructor(e,i){const n=this;n.instanceID=E,E+=1,n.$container=e,n.images=[],n.defaults={itemSelector:".fj-gallery-item",imageSelector:"img",gutter:10,rowHeight:320,rowHeightTolerance:.25,maxRowsCount:Number.POSITIVE_INFINITY,edgeCaseMinRowHeight:.5,edgeCaseMaxRowHeight:2.5,lastRow:"left",transitionDuration:"0.3s",calculateItemsHeight:!1,resizeDebounce:100,isRtl:n.css(n.$container,"direction")==="rtl",onInit:null,onDestroy:null,onAppendImages:null,onBeforeJustify:null,onJustify:null};const o=n.$container.dataset||{},s={};Object.keys(o).forEach(a=>{const r=a.substr(0,1).toLowerCase()+a.substr(1);r&&typeof n.defaults[r]<"u"&&(s[r]=o[a])}),n.options={...n.defaults,...s,...i},n.pureOptions={...n.options},n.resize=F(n.options.resizeDebounce,n.resize),n.justify=T(n.justify.bind(n)),n.init()}css(e,i){return typeof i=="string"?g.getComputedStyle(e).getPropertyValue(i):(Object.keys(i).forEach(n=>{e.style[n]=i[n]}),e)}applyTransition(e,i){const n=this;n.onTransitionEnd(e)(),n.css(e,{"transition-property":i.join(", "),"transition-duration":n.options.transitionDuration}),e.addEventListener("transitionend",n.onTransitionEnd(e,i),!1)}onTransitionEnd(e){const i=this;return()=>{i.css(e,{"transition-property":"","transition-duration":""}),e.removeEventListener("transitionend",i.onTransitionEnd(e))}}addToFjGalleryList(){b.push(this),p()}removeFromFjGalleryList(){const e=this;b.forEach((i,n)=>{i.instanceID===e.instanceID&&b.splice(n,1)})}init(){const e=this;e.appendImages(e.$container.querySelectorAll(e.options.itemSelector)),e.addToFjGalleryList(),e.options.onInit&&e.options.onInit.call(e)}appendImages(e){const i=this;g.jQuery&&e instanceof g.jQuery&&(e=e.get()),!(!e||!e.length)&&(e.forEach(n=>{if(n&&!n.fjGalleryImage&&n.querySelector){const o=n.querySelector(i.options.imageSelector);if(o){n.fjGalleryImage=i;const s={$item:n,$image:o,width:parseFloat(o.getAttribute("width"))||!1,height:parseFloat(o.getAttribute("height"))||!1,loadSizes(){const a=this;B(o,r=>{(a.width!==r.width||a.height!==r.height)&&(a.width=r.width,a.height=r.height,i.resize())})}};s.loadSizes(),i.images.push(s)}}}),i.options.onAppendImages&&i.options.onAppendImages.call(i,[e]),i.justify())}justify(){const e=this,i=[];e.justifyCount=(e.justifyCount||0)+1,e.options.onBeforeJustify&&e.options.onBeforeJustify.call(e),e.images.forEach(h=>{h.width&&h.height&&i.push(h.width/h.height)});const n={containerWidth:e.$container.getBoundingClientRect().width,containerPadding:{top:parseFloat(e.css(e.$container,"padding-top"))||0,right:parseFloat(e.css(e.$container,"padding-right"))||0,bottom:parseFloat(e.css(e.$container,"padding-bottom"))||0,left:parseFloat(e.css(e.$container,"padding-left"))||0},boxSpacing:e.options.gutter,targetRowHeight:e.options.rowHeight,targetRowHeightTolerance:e.options.rowHeightTolerance,maxNumRows:e.options.maxRowsCount,edgeCaseMinRowHeight:e.options.edgeCaseMinRowHeight,edgeCaseMaxRowHeight:e.options.edgeCaseMaxRowHeight,showWidows:e.options.lastRow!=="hide"},o=z(i,n);if(o.widowCount&&(e.options.lastRow==="center"||e.options.lastRow==="right")){const h=o.boxes[o.boxes.length-1];let l=n.containerWidth-h.width-h.left;e.options.lastRow==="center"&&(l/=2),e.options.lastRow==="right"&&(l-=n.containerPadding.right);for(let c=1;c<=o.widowCount;c+=1)o.boxes[o.boxes.length-c].left=o.boxes[o.boxes.length-c].left+l}e.options.isRtl&&o.boxes.forEach((h,l)=>{o.boxes[l].left=n.containerWidth-o.boxes[l].left-o.boxes[l].width-n.containerPadding.right+n.containerPadding.left});let s=0,a=0;const r={};e.images.forEach((h,l)=>{if(o.boxes[s]&&h.width&&h.height){if(e.options.calculateItemsHeight&&typeof r[o.boxes[s].row]>"u"&&Object.keys(r).length&&(a+=r[Object.keys(r).pop()]-o.boxes[l-1].height),e.options.transitionDuration&&e.justifyCount>1&&e.applyTransition(h.$item,["transform"]),e.css(h.$item,{display:"",position:"absolute",transform:`translateX(${o.boxes[s].left}px) translateY(${o.boxes[s].top+a}px) translateZ(0)`,width:`${o.boxes[s].width}px`}),e.options.calculateItemsHeight){const c=h.$item.getBoundingClientRect();(typeof r[o.boxes[s].row]>"u"||r[o.boxes[s].row]<c.height)&&(r[o.boxes[s].row]=c.height)}s+=1}else e.css(h.$item,{display:"none"})}),e.options.calculateItemsHeight&&Object.keys(r).length&&(a+=r[Object.keys(r).pop()]-o.boxes[o.boxes.length-1].height),e.options.transitionDuration&&e.applyTransition(e.$container,["height"]),e.css(e.$container,{height:`${o.containerHeight+a}px`}),e.options.onJustify&&e.options.onJustify.call(e)}updateOptions(e){const i=this;i.options={...i.options,...e},i.justify()}destroy(){const e=this;e.removeFromFjGalleryList(),e.justifyCount=0,e.options.onDestroy&&e.options.onDestroy.call(e),e.css(e.$container,{height:"",transition:""}),e.images.forEach(i=>{e.css(i.$item,{position:"",transform:"",transition:"",width:"",height:""})}),e.images.forEach(i=>{delete i.$item.fjGalleryImage}),delete e.$container.fjGallery}resize(){this.justify()}}const $=function(t,e,...i){(typeof HTMLElement=="object"?t instanceof HTMLElement:t&&typeof t=="object"&&t!==null&&t.nodeType===1&&typeof t.nodeName=="string")&&(t=[t]);const n=t.length;let o=0,s;for(o;o<n;o+=1)if(typeof e=="object"||typeof e>"u"?t[o].fjGallery||(t[o].fjGallery=new M(t[o],e)):t[o].fjGallery&&(s=t[o].fjGallery[e].apply(t[o].fjGallery,i)),typeof s<"u")return s;return t};$.constructor=M;export{$ as f};
